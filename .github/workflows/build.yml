name: Build and Release

on:
  push:
    tags: [ 'v*' ]

permissions:
  contents: write

jobs:
  create-release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Create Release Notes
        run: |
          cat > RELEASE_NOTES.md << 'NOTES'
          # Proton Drive Desktop ${{ github.ref_name }}

          ## Installation

          ### One-Line Install
          ```bash
          npx github:donniedice/protondrive-tauri
          ```

          ### Manual Download
          - **Linux**: Download the .AppImage, .deb, or .rpm file below
          - **macOS**: Download the .dmg file
          - **Windows**: Download the .exe or .msi file

          ## Checksums
          All files include SHA256 checksums for verification.
          NOTES

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          body_path: RELEASE_NOTES.md
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
